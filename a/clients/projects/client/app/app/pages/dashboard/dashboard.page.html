<div class="dashboard">
	<div class="dashboard__content">
		<div class="dashboard__header">
			<div class="dashboard__welcome"
				*ngIf="!userState.isLoading && !userState.hasUserErrors">
				<h1 class="dashboard__title">
					{{ 'pages.dashboard.title' | translate }}
					<span class="dashboard__user-name"> {{ userState.user.firstName }}</span>!
				</h1>
			</div>
			<div class="dashboard__consolidated-balance"
				*ngIf="!accountState.loading && !accountState.hasErrorAccounts">
				<mcy-account-total-balance
					*ngIf="serviceDebtsState.searchedDebts && !serviceDebtsState.loading"
					[totalBalanceByCurrency]="totalBalanceByCurrency">
				</mcy-account-total-balance>
			</div>
		</div>
		<div class="dashboard__summary"
			*ngIf="!accountState.loading && !accountState.hasErrorAccounts">
			<mcy-account-selector
				*ngIf="accountState.accounts.length"
				[title]="'pages.dashboard.summary' | translate"
				[accountList]="accountState.accounts"
				[isCensored]="true"
				(accountSelected)="changeAccount($event);">
			</mcy-account-selector>
		</div>

		<div class="dashboard__account-section"
			*ngIf="!accountState.loading && !accountState.hasErrorAccounts">
			<div class="dashboard__account-info">
				<mcy-account-details
					*ngIf="accountState.accounts.length"
					[businessName]="enterpriseState.selectedEnterprise.name"
					[account]="selectedAccount">
				</mcy-account-details>
			</div>

			<div class="dashboard__last-movements">
				<mcy-account-movements
					*ngIf="!movementsState.isLoading && movementsState.selectedAccount && !movementsState.hasMovementsErrors"
					[movements]="movements">
				</mcy-account-movements>
				<voxel-loading-circle
					class="dashboard__spinner"
					*ngIf="movementsState.isLoading"
					[showLoading]="true"
					size="large">
				</voxel-loading-circle>
				<div class="dashboard__error"
					*ngIf="movementsState.hasMovementsErrors && !movementsState.isLoading">
					<mcy-loading-data-error
						[displayRetry]="true"
						(handleOnRetry)="onSubmitMovements()"
					></mcy-loading-data-error>
				</div>
			</div>
		</div>

		<div class="dashboard__checks-section">
			<mcy-checks-details
				[account]="selectedAccount"
				*ngIf="!accountState.loading && !accountState.hasErrorAccounts">
			</mcy-checks-details>
		</div>
	</div>

	<div class="dashboard__error"
		*ngIf="userState.hasUserErrors || accountState.hasErrorAccounts && !(userState.isLoading || accountState.loading)">
		<mcy-loading-data-error
			[displayRetry]="true"
			(handleOnRetry)="onSubmit()"
		></mcy-loading-data-error>
	</div>

	<div class="dashboard__loading"
		*ngIf="userState.isLoading || accountState.loading">
		<voxel-loading-circle
			class="dashboard__spinner"
			[showLoading]="true"
			size="large">
		</voxel-loading-circle>
	</div>

	<div class="dashboard__container">
		<div class="dashboard__upcoming-maturities">
			<mcy-upcoming-maturities
				*ngIf="!serviceDebtsState.loading && !serviceDebtsState.hasServiceDebtsErrors"
				[debtsList]="serviceDebtsState.debts">
			</mcy-upcoming-maturities>
			<voxel-loading-circle
				class="dashboard__spinner"
				*ngIf="serviceDebtsState.loading"
				[showLoading]="true"
				size="large">
			</voxel-loading-circle>
			<div class="dashboard__error"
				*ngIf="serviceDebtsState.hasServiceDebtsErrors && !serviceDebtsState.loading">
				<mcy-loading-data-error
					[displayRetry]="true"
					(handleOnRetry)="onSubmitDebts()">
				</mcy-loading-data-error>
			</div>
		</div>

		<div class="dashboard__favorite-contacts">
			<mcy-favorite-contacts
				[favoriteContacts]="favoriteContacts"
				*ngIf="!contactState.loading && !contactState.hasErrorContacts">
			</mcy-favorite-contacts>
			<voxel-loading-circle
				class="dashboard__spinner"
				*ngIf="contactState.loading"
				[showLoading]="true"
				size="large">
			</voxel-loading-circle>
			<div class="dashboard__error"
				*ngIf="contactState.hasErrorContacts && !contactState.loading">
				<mcy-loading-data-error
					[displayRetry]="true"
					(handleOnRetry)="onSubmitContacts()">
				</mcy-loading-data-error>
			</div>
		</div>
	</div>
</div>